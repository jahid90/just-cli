version: 6
commands:
  build:
    description: Build the cli
    steps:
      - name: Build
        run: go build
  install:
    description: Install the cli globally
    steps:
      - name: Install
        env:
          - COMMIT=abc
          - ENV=production
        run: go install -ldflags "-X main.GitCommit=$COMMIT -X main.Environment=$ENV"
  test:v1:
    steps:
      - run: just --config-file test-data/just.v1.json --list
  test:v2:
    steps:
      - run: just --config-file test-data/just.v2.json --list
  test:v3:
    steps:
      - run: just --config-file test-data/just.v3.json --list
  test:v4:
    steps:
      - run: just --config-file test-data/just.v4.json --list
  test:v5:
    steps:
      - run: just --config-file test-data/just.v5.yaml --list
  test:v6:
    steps:
      - run: just --config-file test-data/just.v6.yaml --list
  test:v7:
    steps:
      - run: just --config-file test-data/just.v7.yaml --list
  hello:
    description: Says hello
    steps:
      - run: echo hello
  multi:step:
    description: Run a multi-step alias
    needs:
      - hello
    steps:
      - name: list dir contents
        run: ls
      - name: say bye
        run: echo bye
